# Problem 04: Count total requests and total download size by month

## Requirements
- python3
- hadoop
- mrjob

## Solution Implementation
```python
from mrjob.job import MRJob
import re
class MRImageCount(MRJob):
	def mapper(self, _, line):
		pattern = r"\[(\d{2})/([A-Z]{1}[a-z]{2})/(\d{4}):(\d{2}):(\d{2}):(\d{2}) [+-]([\d]{4})\][^[\]]+(\d{3}) (\d+) \""
		data = re.search(pattern, line)
		if data:
			data = data.groups()
			mm = data[1]
			yy = data[2]
			date = "{}-{}".format(yy, mm)
			size = data[8]
			yield (date, (1, int(size)))

	def reducer(self, month, iterator):
		requests, size = map(sum, zip(*iterator))
		yield(month, (requests, size))
if __name__ == '__main__':
	MRImageCount.run()
```

## How to Run Solution
To run this python program, grab a copy of the current directory
from GitHub. After that, get the latest version of `python` and install `mrjob` using following command
```console
pip install mrjob
```
Now, all you have to do is run the following command from the command line:
```console
python MonthSummary.py input/web_access_log.txt -r hadoop > output/month_summary.txt
```

## Output
The output file generated by hadoop is located in output directory.

|    Month    | requests | total downloads |
|-------------|----------|-----------------|
| "2016-Feb"  |  64113   |    1412992330   |
| "2015-Dec"  |  13669   |    286875357    |
| "2016-Jan"  |  28065   |    1840852372   |

